---
// src/pages/plans/create.astro
// Strona tworzenia nowego planu treningowego

import Layout from "@/layouts/Layout.astro";
import { PlanWizard } from "@/components/training-plan/PlanWizard";
import { Toaster } from "@/components/ui/sonner";

// Pobierz query param step (opcjonalnie)
const url = new URL(Astro.request.url);
const stepParam = url.searchParams.get("step");
const initialStep = stepParam ? parseInt(stepParam, 10) : 1;

// Walidacja step (1, 2, lub 3)
const validStep = initialStep >= 1 && initialStep <= 3 ? (initialStep as 1 | 2 | 3) : 1;

// TODO: Middleware do sprawdzenia autentykacji
// Jeśli użytkownik nie jest zalogowany, przekieruj do /login?redirect=/plans/create
---

<Layout title="Nowy plan treningowy" showNavigation>
  <PlanWizard mode="create" initialStep={validStep} client:load />
  <Toaster client:load />
</Layout>
